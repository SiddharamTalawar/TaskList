<!DOCTYPE html>
<html>
  <head>
    <title>Task List</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
    />
    <style>
      /* Hover effect for table rows */
      .table-hover tbody tr:hover {
        background-color: #f5f5f5;
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4">Task List</h1>

      <!-- Notification Area -->
      <div
        id="notification"
        class="alert alert-info"
        role="alert"
        style="display: none"
      >
        <!-- Notification message will be inserted here -->
      </div>

      <form method="get" class="mb-3">
        <div class="row">
          <div class="col-md-3">
            <label for="status" class="form-label">Filter by Status:</label>
            <select name="status" id="status" class="form-select">
              <option value="">All</option>
              <option value="TODO">To Do</option>
              <option value="IN_PROGRESS">In Progress</option>
              <option value="DONE">Done</option>
            </select>
          </div>
          <div class="col-md-3">
            <label for="priority" class="form-label">Filter by Priority:</label>
            <select name="priority" id="priority" class="form-select">
              <option value="">All</option>
              <option value="1">HIGH</option>
              <option value="2">MEDIUM</option>
              <option value="3">LOW</option>
            </select>
          </div>
          <div class="col-md-3">
            <label for="due_date" class="form-label">Filter by Due Date:</label>
            <input
              type="date"
              name="due_date"
              id="due_date"
              class="form-control"
            />
          </div>
          <div class="col-md-3">
            <label for="search" class="form-label">Search:</label>
            <input
              type="text"
              name="q"
              id="search"
              class="form-control"
              placeholder="Search by title/description..."
            />
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-12 d-flex justify-content-end">
            <button type="submit" class="btn btn-primary">Apply</button>
          </div>
        </div>
      </form>
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Title</th>
            <th>Description</th>
            <th>Due Date</th>
            <th>Priority</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}

          <tr data-id="{{ task.id }}">
            <td>{{ task.title }}</td>
            <!-- Truncate the description if it exceeds 20 characters -->
            {% if task.description|length > 20 %}
            <td>{{ task.description | truncatechars:20 }}</td>
            {% else %}
            <td>{{ task.description }}</td>
            {% endif %}
            <td>{{ task.due_date }}</td>
            <td>{{ task.get_priority_display }}</td>
            <td>{{ task.get_status_display }}</td>

            <!-- <td><a href="/update-task/{{ task.id }}/">Edit</a></td> -->
            <td style="margin-top: -10px">
              <a href="/delete-task/{{ task.id }}/"
                ><i class="bi bi-trash text-danger"></i
              ></a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var rows = document.querySelectorAll("table tbody tr");
        rows.forEach(function (row) {
          row.addEventListener("click", function () {
            var taskId = this.getAttribute("data-id");
            window.location.href = "/update-task/" + taskId + "/";
          });
        });
      });
      // function to hide a notification
      function hideNotification() {
        var notification = document.getElementById("notification");
        notification.style.display = "none";
      }
      // function to show a notification
      function showNotification(message) {
        var notification = document.getElementById("notification");
        notification.innerText = message;
        notification.style.display = "block";
      }

      // Example usage
      showNotification("This is a notification message.");
    </script>
  </body>
</html>
